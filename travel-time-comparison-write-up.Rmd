---
title: "Travel Time"
author: "PSU"
date: "2/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyr)
library(dygraphs)

```

## Methods
Date range of comparison is 2019-02-03 through 2019-03-03.
Corridors selected are:
- I-5 NB, Jantzen Beach to Main St.
- I-205 NB, Airport Way to Padden Parkway
- I-205 SB, Padden Parkway to Airport Way

### Data collection
_INRIX_
Raw, one minute data were used. For hourly averaged travel time along the corridor, data with a confidence score less than 30 (3% of available data), C-Value less than 75, and NA were excluded.


## Results
### I-5 NB, Janzten Beach to Main St.
```{r}
nb_i5_jantzen_tt_inrix <- readRDS("data/nb_i5_jantzen_tt_inrix.rds")
nb_i5_jantzen_tt_its <- read.csv("data/portal/i5-jantzen-main-portal.csv", stringsAsFactors = F)

nb_i5_jantzen_tt_its$time <- lubridate::ymd_hms(nb_i5_jantzen_tt_its$time)
nb_i5_jantzen_tt_its <- nb_i5_jantzen_tt_its %>%
  select(datetime = time, traveltime = travel.time) %>%
  mutate(source = "ITS")

# nb_i5_jantzen_tt <- bind_rows(nb_i5_jantzen_tt_inrix, nb_i5_jantzen_tt_its) %>%
#   mutate(week = as.character(floor_date(datetime, "week")))

# Create xts for dygraph
nb_i5_jantzen_tt <- data.frame(
  datetime = seq(
    from = as.POSIXct("2019-02-03 00:00:00", tz = "America/Los_Angeles"),
    to = as.POSIXct("2019-03-03 00:00:00", tz = "America/Los_Angeles"),
    by = "hour"
  )
) %>%
  left_join(nb_i5_jantzen_tt_its, by = "datetime") %>%
  select(datetime, ITS = traveltime) %>%
  left_join(nb_i5_jantzen_tt_inrix, by = "datetime") %>%
  select(datetime, ITS, INRIX = traveltime)

nb_i5_jantzen_tt <- tibble::column_to_rownames(nb_i5_jantzen_tt, var = "datetime")

nb_i5_jantzen_tt_xts <- as.xts(nb_i5_jantzen_tt)

# Create figure

dygraph(nb_i5_jantzen_tt_xts)
```

